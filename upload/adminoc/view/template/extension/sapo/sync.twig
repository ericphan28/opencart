{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="button" id="test-connection" class="btn btn-info">
          <i class="fa fa-plug"></i> Kiá»ƒm Tra Káº¿t Ná»‘i Sapo
        </button>
      </div>
      <h1>ğŸŒ± An NhiÃªn Farm - Äá»“ng Bá»™ Sapo</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if not sapo_configured %}
    <div class="alert alert-warning">
      <i class="fa fa-exclamation-triangle"></i>
      <strong>Cáº£nh bÃ¡o!</strong> Sapo API chÆ°a Ä‘Æ°á»£c cáº¥u hÃ¬nh. 
      <a href="{{ config_link }}">Vui lÃ²ng cáº¥u hÃ¬nh Sapo API</a> trÆ°á»›c khi sá»­ dá»¥ng.
    </div>
    {% endif %}
    
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          <i class="fa fa-refresh"></i> Äá»“ng Bá»™ Dá»¯ Liá»‡u An NhiÃªn Farm
        </h3>
      </div>
      <div class="panel-body">
        
        <!-- Sync Products -->
        <div class="row">
          <div class="col-md-4">
            <div class="panel panel-success">
              <div class="panel-heading">
                <h4><i class="fa fa-leaf"></i> Sáº£n Pháº©m NÃ´ng Sáº£n</h4>
              </div>
              <div class="panel-body">
                <p>Äá»“ng bá»™ sáº£n pháº©m tá»« Sapo vá» OpenCart</p>
                <ul class="list-unstyled">
                  <li>ğŸ¥¬ Rau xanh tÆ°Æ¡i</li>
                  <li>ğŸ¥• Cá»§ quáº£ tÆ°Æ¡i</li>
                  <li>ğŸ TrÃ¡i cÃ¢y tÆ°Æ¡i</li>
                  <li>ğŸŒ¿ Tháº£o má»™c & gia vá»‹</li>
                  <li>ğŸ¥© Thá»‹t bÃ² nháº­p kháº©u</li>
                  <li>ğŸ¦ Háº£i sáº£n Ä‘Ã´ng láº¡nh</li>
                  <li>ğŸ¯ NÆ°á»›c sá»‘t tiá»‡n lá»£i</li>
                </ul>
                <button type="button" id="sync-products" class="btn btn-success btn-block">
                  <i class="fa fa-download"></i> Äá»“ng Bá»™ Sáº£n Pháº©m
                </button>
              </div>
            </div>
          </div>
          
          <!-- Sync Orders -->
          <div class="col-md-4">
            <div class="panel panel-primary">
              <div class="panel-heading">
                <h4><i class="fa fa-shopping-cart"></i> ÄÆ¡n HÃ ng</h4>
              </div>
              <div class="panel-body">
                <p>Äá»“ng bá»™ Ä‘Æ¡n hÃ ng tá»« OpenCart lÃªn Sapo</p>
                <ul class="list-unstyled">
                  <li>ğŸ“¦ ÄÆ¡n hÃ ng má»›i</li>
                  <li>ğŸ’° ThÃ´ng tin thanh toÃ¡n</li>
                  <li>ğŸšš Äá»‹a chá»‰ giao hÃ ng</li>
                  <li>ğŸ“ ThÃ´ng tin liÃªn há»‡</li>
                  <li>ğŸ“Š Tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng</li>
                </ul>
                <button type="button" id="sync-orders" class="btn btn-primary btn-block">
                  <i class="fa fa-upload"></i> Äá»“ng Bá»™ ÄÆ¡n HÃ ng
                </button>
              </div>
            </div>
          </div>
          
          <!-- Sync Customers -->
          <div class="col-md-4">
            <div class="panel panel-info">
              <div class="panel-heading">
                <h4><i class="fa fa-users"></i> KhÃ¡ch HÃ ng</h4>
              </div>
              <div class="panel-body">
                <p>Äá»“ng bá»™ thÃ´ng tin khÃ¡ch hÃ ng</p>
                <ul class="list-unstyled">
                  <li>ğŸ‘¤ ThÃ´ng tin cÃ¡ nhÃ¢n</li>
                  <li>ğŸ“§ Email liÃªn há»‡</li>
                  <li>ğŸ“± Sá»‘ Ä‘iá»‡n thoáº¡i</li>
                  <li>ğŸ  Äá»‹a chá»‰ giao hÃ ng</li>
                  <li>ğŸ·ï¸ PhÃ¢n loáº¡i khÃ¡ch hÃ ng</li>
                </ul>
                <button type="button" id="sync-customers" class="btn btn-info btn-block">
                  <i class="fa fa-upload"></i> Äá»“ng Bá»™ KhÃ¡ch HÃ ng
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Sync Status -->
        <div class="row">
          <div class="col-md-12">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4><i class="fa fa-info-circle"></i> Tráº¡ng ThÃ¡i Äá»“ng Bá»™</h4>
              </div>
              <div class="panel-body">
                <div id="sync-status">
                  <p class="text-muted">
                    <i class="fa fa-info-circle"></i> 
                    Nháº¥n "Kiá»ƒm Tra Káº¿t Ná»‘i Sapo" Ä‘á»ƒ kiá»ƒm tra káº¿t ná»‘i vá»›i há»‡ thá»‘ng Sapo.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Farm Information -->
        <div class="row">
          <div class="col-md-12">
            <div class="alert alert-info">
              <h4><i class="fa fa-leaf"></i> Vá» An NhiÃªn Farm</h4>
              <p>
                <strong>An NhiÃªn Farm</strong> chuyÃªn cung cáº¥p Ä‘a dáº¡ng thá»±c pháº©m cháº¥t lÆ°á»£ng cao: 
                nÃ´ng sáº£n sáº¡ch tá»« nÃ´ng tráº¡i, thá»‹t bÃ² nháº­p kháº©u cao cáº¥p, háº£i sáº£n Ä‘Ã´ng láº¡nh tÆ°Æ¡i ngon vÃ  cÃ¡c loáº¡i nÆ°á»›c sá»‘t tiá»‡n lá»£i. 
                Há»‡ thá»‘ng Ä‘á»“ng bá»™ nÃ y giÃºp káº¿t ná»‘i dá»¯ liá»‡u giá»¯a website bÃ¡n hÃ ng vÃ  há»‡ thá»‘ng quáº£n lÃ½ Sapo POS.
              </p>
              <ul class="list-inline">
                <li><strong>ğŸŒ± NÃ´ng sáº£n há»¯u cÆ¡</strong></li>
                <li><strong>ğŸ¥© Thá»‹t bÃ² nháº­p kháº©u</strong></li>
                <li><strong>ğŸ¦ Háº£i sáº£n cao cáº¥p</strong></li>
                <li><strong>ğŸ¯ NÆ°á»›c sá»‘t tiá»‡n lá»£i</strong></li>
                <li><strong>ğŸšš Giao hÃ ng táº­n nÆ¡i</strong></li>
                <li><strong>ğŸ“± Quáº£n lÃ½ hiá»‡n Ä‘áº¡i</strong></li>
              </ul>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function() {
    // Test Sapo Connection
    $('#test-connection').on('click', function() {
        var button = $(this);
        button.prop('disabled', true);
        button.html('<i class="fa fa-spinner fa-spin"></i> Äang kiá»ƒm tra...');
        
        $.ajax({
            url: '{{ test_connection }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    $('#sync-status').html(
                        '<div class="alert alert-success">' +
                        '<i class="fa fa-check"></i> ' + response.success +
                        '</div>'
                    );
                } else if (response.error) {
                    $('#sync-status').html(
                        '<div class="alert alert-danger">' +
                        '<i class="fa fa-times"></i> ' + response.error +
                        '</div>'
                    );
                }
            },
            error: function() {
                $('#sync-status').html(
                    '<div class="alert alert-danger">' +
                    '<i class="fa fa-times"></i> Lá»—i káº¿t ná»‘i Ä‘áº¿n server' +
                    '</div>'
                );
            },
            complete: function() {
                button.prop('disabled', false);
                button.html('<i class="fa fa-plug"></i> Kiá»ƒm Tra Káº¿t Ná»‘i Sapo');
            }
        });
    });
    
    // Sync Products
    $('#sync-products').on('click', function() {
        performSync($(this), '{{ sync_products }}', 'Äang Ä‘á»“ng bá»™ sáº£n pháº©m...', '<i class="fa fa-download"></i> Äá»“ng Bá»™ Sáº£n Pháº©m');
    });
    
    // Sync Orders
    $('#sync-orders').on('click', function() {
        performSync($(this), '{{ sync_orders }}', 'Äang Ä‘á»“ng bá»™ Ä‘Æ¡n hÃ ng...', '<i class="fa fa-upload"></i> Äá»“ng Bá»™ ÄÆ¡n HÃ ng');
    });
    
    // Sync Customers
    $('#sync-customers').on('click', function() {
        performSync($(this), '{{ sync_customers }}', 'Äang Ä‘á»“ng bá»™ khÃ¡ch hÃ ng...', '<i class="fa fa-upload"></i> Äá»“ng Bá»™ KhÃ¡ch HÃ ng');
    });
    
    function performSync(button, url, loadingText, originalText) {
        button.prop('disabled', true);
        button.html('<i class="fa fa-spinner fa-spin"></i> ' + loadingText);
        
        $.ajax({
            url: url,
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                var alertClass = 'alert-success';
                var icon = 'fa-check';
                var message = response.success;
                
                if (response.error) {
                    alertClass = 'alert-danger';
                    icon = 'fa-times';
                    message = response.error;
                } else if (response.warnings) {
                    alertClass = 'alert-warning';
                    icon = 'fa-exclamation-triangle';
                    message += '<br><br><strong>Cáº£nh bÃ¡o:</strong><ul>';
                    for (var i = 0; i < response.warnings.length; i++) {
                        message += '<li>' + response.warnings[i] + '</li>';
                    }
                    message += '</ul>';
                }
                
                $('#sync-status').html(
                    '<div class="alert ' + alertClass + '">' +
                    '<i class="fa ' + icon + '"></i> ' + message +
                    '</div>'
                );
            },
            error: function() {
                $('#sync-status').html(
                    '<div class="alert alert-danger">' +
                    '<i class="fa fa-times"></i> Lá»—i káº¿t ná»‘i Ä‘áº¿n server' +
                    '</div>'
                );
            },
            complete: function() {
                button.prop('disabled', false);
                button.html(originalText);
            }
        });
    }
});
</script>

{{ footer }}
